---
title: "Password Cracking Techniques"
type: handbook
weight: 1
---

### John The Ripper

#### Cracking Modes

##### Single Crack Mode

```bash
john --single passwd
```

##### Wordlist Mode

```bash
john --wordlist=<wordlist_file> <hash_file>
```

##### Incremental Mode

```bash
john --incremental <hash_file>
```

#### Cracking Files

```bash
<tool> <file_to_crack> > file.hash
```

|Tool 		  | Description 								 |
|-------------|----------------------------------------------|
|pdf2john 	  | Converts PDF documents for John 			 |
|ssh2john 	  | Converts SSH private keys for John 			 |
|mscash2john  |	Converts MS Cash hashes for John 			 |
|keychain2john| Converts OS X keychain files for John 		 |
|rar2john 	  | Converts RAR archives for John 				 |
|pfx2john 	  | Converts PKCS#12 files for John 			 |
|keepass2john |	Converts KeePass databases for John 		 |
|vncpcap2john |	Converts VNC PCAP files for John 			 |
|putty2john   |	Converts PuTTY private keys for John  		 |
|zip2john 	  | Converts ZIP archives for John 				 |
|hccap2john   |	Converts WPA/WPA2 handshake captures for John|
|office2john  |	Converts MS Office documents for John 		 |
|wpa2john 	  | Converts WPA/WPA2 handshakes for John 		 |

### Identifying Hash Formats

```bash
hashid -j <hash>
```

### Hashcat

```bash
hashcat -a 0 -m 0 <hashes> [wordlist, rule, mask, ...]
```

In the command above:

* `-a` is used to specify the attack mode
* `-m` is used to specify the hash type
* `<hashes>` is a either a hash string, or a file containing one or more password hashes of the same type
* `[wordlist, rule, mask, ...]` is a placeholder for additional arguments that depend on the attack mode

#### Attack Modes

##### Dictionary Attack

```bash
hashcat -a 0 -m 0 <hash> <wordlist>
```

##### Hashcat Rules

```bash
ls -l /usr/share/hashcat/rules
```

##### Mask Attack

|Symbol   |	Charset                            |
|---------|------------------------------------|
|?l 	  |abcdefghijklmnopqrstuvwxyz 		   |
|?u 	  |ABCDEFGHIJKLMNOPQRSTUVWXYZ 		   |
|?d 	  |0123456789 						   |
|?h 	  |0123456789abcdef					   |
|?H 	  |0123456789ABCDEF					   |
|?s 	  |«space»!"#$%&'()*+,-./:;<=>?@[]^_`{ |
|?a 	  |?l?u?d?s 						   |
|?b 	  |0x00 - 0xff 						   |	

```bash
hashcat -a 3 -m 0 <hash> '?u?l?l?l?l?d?s'
```

### Customizing Wordlists

##### Wordlist using Hashcat

|Function |Description|
|---------|-----------|
|: 		  |Do nothing|
|l 		  |Lowercase all letters|
|u 		  |Uppercase all letters|
|c 		  |Capitalize the first letter and lowercase others|
|sXY 	  |Replace all instances of X with Y|
|$! 	  |Add the exclamation character at the end|

##### Generating wordlists using CeWL

```bash
cewl https://www.inlanefreight.com -d 4 -m 6 --lowercase -w inlane.wordlist
```

### Cracking Protected Files

#### Hunting for Encrypted Files

```bash
for ext in $(echo ".xls .xls* .xltx .od* .doc .doc* .pdf .pot .pot* .pp*");do echo -e "\nFile extension: " $ext; find / -name *$ext 2>/dev/null | grep -v "lib\|fonts\|share\|core" ;done
```

#### Hunting for SSH keys

```bash
grep -rnE '^\-{5}BEGIN [A-Z0-9]+ PRIVATE KEY\-{5}$' /* 2>/dev/null
```

#### Cracking encrypted SSH keys

```bash
locate *2john*
```

```bash
ssh2john.py SSH.private > ssh.hash
john --wordlist=rockyou.txt ssh.hash
john ssh.hash --show
```

#### Cracking password-protected documents

```bash
office2john.py Protected.docx > protected-docx.hash
john --wordlist=rockyou.txt protected-docx.hash
john protected-docx.hash --show
```

```bash
pdf2john.py PDF.pdf > pdf.hash
john --wordlist=rockyou.txt pdf.hash
john pdf.hash --show
```

### Cracking Protected Archives

#### Cracking ZIP files

```bash
zip2john ZIP.zip > zip.hash
cat zip.hash
john --wordlist=rockyou.txt zip.hash
john zip.hash --show
```

#### Cracking OpenSSL encrypted GZIP files

```bash
file GZIP.gzip 
for i in $(cat rockyou.txt);do openssl enc -aes-256-cbc -d -in GZIP.gzip -k $i 2>/dev/null| tar xz;done
```

#### Cracking BitLocker-encrypted drives

```bash
bitlocker2john -i Backup.vhd > backup.hashes
grep "bitlocker\$0" backup.hashes > backup.hash
cat backup.hash
hashcat -a 0 -m 22100 <hash> /usr/share/wordlists/rockyou.txt
```

##### Mounting BitLocker-encrypted drives in Linux 

```bash
sudo apt-get install dislocker
```

```bash
sudo mkdir -p /media/bitlocker
sudo mkdir -p /media/bitlockermount
```

Configure VHD as loop device

```bash
sudo losetup -f -P Backup.vhd
lsblk
sudo dislocker /dev/loop0p2 -u1234qwer -- /media/bitlocker
sudo mount -o loop /media/bitlocker/dislocker-file /media/bitlockermount
```

```bash
cd /media/bitlockermount/
```

```bash
sudo umount /media/bitlockermount
sudo umount /media/bitlocker
```
